# 非負行列分解(NMF)
@yhiss
shinjuku もくもくプログラミング #33

## WHO
- 金融機関でデータ分析
- 初めてdropbox paper使ったので、勝手がよくわかっていない
- 今日は~~kaggle~~と**非負行列分解**の理解を進めてました



# 概要
## 行列分解とは

$$U = \mathbb{R}^{I\times J}$$を
$$U=WH$$と2行列$$W = \mathbb{R}^{I\times K}$$,$$H = \mathbb{R}^{K\times J}$$の積に分解する


## 非負行列分解
- 次元削減方法の一つ
- $$U \simeq WH$$と近似する
- データをベクトル表記する
  (似たような手法:主成分分析(PCA),ベクトル量子化(VQ))
- $$W,H$$の各要素を非負($$\geq0$$)に制限する


## 具体的には…
|        | 変数1 | 変数2 | 変数3  | … | 変数99 | 変数100 |
| ------ | --- | --- | ---- | - | ---- | ----- |
| 顧客1    | 0.3 | 2   | 0.03 |   | 60   | 500   |
| 顧客2    | 0.1 | 5   | 0.04 |   | 30   | 200   |
| …      |     |     |      |   |      |       |
| 顧客1000 | 0.6 | 6   | 0.21 |   | 15   | 100   |

上の行列(1000X100)を 

|        | 特徴量1 | 特徴量2 | … | 特徴量5 |
| ------ | ---- | ---- | - | ---- |
| 顧客1    | 0.2  | 0.9  |   | 0.03 |
| 顧客2    | 0.5  | 0.8  |   | 0.01 |
| …      |      |      |   |      |
| 顧客1000 | 0.9  | 0.2  |   | 5    |

行列(1000X5)と

|      | 変数1 | 変数2 | 変数3  | … | 変数99 | 変数100 |
| ---- | --- | --- | ---- | - | ---- | ----- |
| 特徴量1 | 2   | 2   | 3    |   | 0.08 | 0.02  |
| 特徴量2 | 5   | 5   | 20   |   | 0.03 | 200   |
| …    |     |     |      |   |      |       |
| 特徴量5 | 0.6 | 6   | 0.21 |   | 15   | 100   |

行列(5X100)に分ける


## 何がうれしいのか？
- 計算量減る
  機械学習モデルを作る時のデータが小さくなるので、計算リソースの軽減できる
- 全部0より大きい
  現実に扱う変数は0以上のものも多い(e.g.閲覧数、アクセス数)
- 直観的な理解がしやすい
  どの変数が似たようなものなのかも知ることができる
- 欠損値の推定にも使える
  分解した後の特徴量でグループ分けした結果、欠損値があっても同じグループの値がわかれば推定できる
# 単純な前処理以外で論文化されてるもの


## **画像認識**

(Learning the parts of objects by non-negative matrix factorization)

- 非負行列分解(NMF)
![画像認識でNMFを使った場合、顔のパーツ毎に分解されている](https://d2mxuefqeaa7sj.cloudfront.net/s_FD518BC827AC4B2EBB322E0389D009570052C0E31F45C1236B13ED194409032A_1549090136419_NMF_gazou.png)

- 主成分分析(PCA)
![PCAを使った場合、直観的にはよくわからない](https://d2mxuefqeaa7sj.cloudfront.net/s_FD518BC827AC4B2EBB322E0389D009570052C0E31F45C1236B13ED194409032A_1549090337541_PCA_gazou.png)



## **画像認識以外の領域**

(能力テストにおける非負行列分解を用いた適応型出題の精度解析:電子情報通信学会)

- 能力テストで出題項目数を削減しても,、全項目を出題した時と同じ精度で能力を推定できればテスト時間の短縮につながる
- 313人の対象者が58問の質問に回答。
  正解ならば1、不正解ならば0として行列を作り、5つのスキルセットに分解
  中央:各回答者が5つの内どのスキルセットを満たしているか
  右:5つのスキルセットはどの質問で測ることができるのか
![](https://d2mxuefqeaa7sj.cloudfront.net/s_FD518BC827AC4B2EBB322E0389D009570052C0E31F45C1236B13ED194409032A_1549092144049_image.png)

![](https://d2mxuefqeaa7sj.cloudfront.net/s_FD518BC827AC4B2EBB322E0389D009570052C0E31F45C1236B13ED194409032A_1549092213203_image.png)

## pythonでの実装

sklearn.demonposition.NMFで前処理は手軽に使える

# まとめ

モデルの精度向上、計算リソース削減のために使われる事も多いNMFだけど、何をしているか理解すればただのモデル開発前処理だけでなく活用余地は割とあると思う

